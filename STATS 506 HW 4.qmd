---
title: "STATS 506 HW 4"
author: "Calder Moore"
format: pdf
editor: visual
---

# STATS 506 HW 4

## Problem 1 - Tidyverse: New Zealand

### 1)

```{r}
library(tidyverse)
library(nzelect)

nztib <- tibble(vote = nzge$votes, year = nzge$election_year, type = nzge$voting_type) %>%
          group_by(type, year) %>%
          summarise(vote_total = sum(vote)) %>%
          arrange(desc(vote_total))

nztib
```

### 2)

```{r}
vote2014 <- tibble(vote = nzge$votes, year = nzge$election_year, party = nzge$party) %>%
              group_by(year, party) %>%
              filter(year == 2014) %>%
              summarise(vote_total = sum(vote)) %>%
              mutate(vote_percent = 100*vote_total/sum(vote_total))
              
vote2014          
```

### 3)

```{r}
win <- tibble(vote = nzge$votes, year = nzge$election_year, party = nzge$party, type = nzge$voting_type) %>%
              group_by(year, party, type) %>%
              summarise(vote_total = sum(vote)) %>%
              group_by(year) %>%
              mutate(vote_percent = 100*vote_total/sum(vote_total)) %>%
              group_by(year, type) %>%
              mutate(winner = party[which.max(vote_percent)]) %>%
              slice_max(vote_percent) %>%
              select(year, type, winner)

win  
```












